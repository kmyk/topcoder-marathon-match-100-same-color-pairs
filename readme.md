# TopCoder Marathon Match 100: SameColorPairs

<https://community.topcoder.com/longcontest/?module=ViewProblemStatement&rd=17143&pm=14889>

## 記録

### 問題概要

H * Wの盤面があり各マスはC種の色のうちどれかで塗られている。
同じ色のマスの対で、それらを含む軸平行長方形内に他の色が存在しないようなものがあれば、それらのマスを無色にできる。
適当な操作列を取り無色のマスの数をできる限り大きくせよ。
(10 ≦ H, W ≦ 100, 2 ≦ C ≦ 6)

### 4/19

問題を読んだ。
初手でそれなりのが出てそこから縮まなさそうだなあという印象。
焼き鈍したいけど文脈が入ってて難しそう。
algoの問題として出てたらフローな気がする。

とりあえず愚直を書いた: `d80706d423b71e45d9acedc05f434216559d5580`。
盤面が大きくて色が少ないのが簡単 (例: `seed = 1000`) で、小さくて色が多いのが難しい (例: `seed = 1004`) ようだ。
難しいのは最後の詰めの部分だけなので最適解狙っていけるのでは。
荒く削って残りをSAT solverに投げたい。

gif出力機能はなぜ配られなかったのか。上位者の出力を眺めてもなぜか最終的にすっきり消えるということしか分からなさそうだが。

初提出は `d80706d423b71e45d9acedc05f434216559d5580` で5位。1日目にしては低めの順位か。

| Handle          | Score           | Rank    | Last Submission Time      | Language  | Example Tests   | Submissions     | Current Rating  | Predicted Rating   | Rating Delta |
|-----------------|-----------------|---------|---------------------------|-----------|-----------------|-----------------|-----------------|--------------------|--------------|
| yowa            | 982058.82       | 1       | 04.19.2018 00:39:05       | C++       | 2               | 2               | 2157            | 2232.77            | 75.77        |
| CatalinT        | 856764.71       | 2       | 04.19.2018 02:53:37       | C++       | 1               | 1               | 2504            | 2504.95            | 0.95         |
| iehn            | 840000.00       | 3       | 04.18.2018 22:19:55       | C++       | 1               | 1               | 1650            | 1758.33            | 108.33       |
| Rustyoldman     | 803529.41       | 4       | 04.19.2018 02:40:42       | C++       | 1               | 2               | 1609            | 1672.40            | 63.40        |
| kimiyuki        | 800294.12       | 5       | 04.19.2018 03:03:27       | C++       | 1               | 1               | 1745            | 1781.11            | 36.11        |
| mmammel         | 742058.82       | 6       | 04.18.2018 23:35:37       | C++       | 1               | 1               | 1292            | 1375.85            | 83.85        |
| accel           | 625882.35       | 7       | 04.19.2018 02:31:05       | C++       | 3               | 2               | 1220            | 1461.28            | 241.28       |

![d80706d423b71e45d9acedc05f434216559d5580](https://user-images.githubusercontent.com/2203128/39096787-58f2cb2e-468f-11e8-98fb-2db9f2123fe9.gif)

時間計測がなんだか変でExample Testsが増えた。まだちゃんとできてないが提出 `cb164952586698062c717fd6584600c2585b9897`。
[Pag2](https://www.topcoder.com/members/Pag2/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんが1位に出てるが青色なので私にも辿り着ける解法だろう。

| Handle        | Score        |  Rank   |  Last Submission Time | Language |  Example Tests | Submissions   | Current Rating |  Predicted Rating |  Rating Delta |
|---------------|--------------|---------|-----------------------|----------|----------------|---------------|----------------|-------------------|---------------|
| Pag2          | 974782.61    |  1      |  04.19.2018 04:03:32  | C++      |  1             | 1             | 1399           |  1576.27          |  177.27       |
| CatalinT      | 921086.96    |  2      |  04.19.2018 04:55:27  | C++      |  3             | 2             | 2504           |  2506.37          |  2.37         |
| yowa          | 911739.13    |  3      |  04.19.2018 00:39:05  | C++      |  2             | 2             | 2157           |  2172.17          |  15.17        |
| kimiyuki      | 904565.22    |  4      |  04.19.2018 05:04:49  | C++      |  8             | 2             | 1745           |  1821.92          |  76.92        |
| iehn          | 789565.22    |  5      |  04.18.2018 22:19:55  | C++      |  1             | 1             | 1650           |  1712.70          |  62.70        |
| Rustyoldman   | 769130.43    |  6      |  04.19.2018 02:40:42  | C++      |  1             | 2             | 1609           |  1643.27          |  34.27        |

![cb164952586698062c717fd6584600c2585b9897](https://user-images.githubusercontent.com/2203128/39096789-5b29041c-468f-11e8-8359-3605f8121458.gif)

次にやるべきは適当なところまで進めて残りを乱択する高速化に思える。
下から貪欲に取って座標圧縮とかをするとよさそう。
ある種の縮退したビームサーチか。

### 4/19 24:00 ~

緑が1位になってる。まあはい。

| Handle       | Score      | Rank | Last Submission Time    | Language   | Example Tests     | Submissions       | Current Rating    | Predicted Rating  | Rating Delta |
|--------------|------------|------|-------------------------|------------|-------------------|-------------------|-------------------|-------------------|--------------|
| ceni1055     | 952627.12  | 1    | 04.19.2018 11:50:49     | C++        | 3                 | 4                 | 1009              | 1659.00           | 650.00       |
| Pag2         | 952627.12  | 1    | 04.19.2018 04:03:32     | C++        | 1                 | 1                 | 1399              | 1576.27           | 177.27       |
| ebicochineal | 933135.59  | 3    | 04.19.2018 11:09:55     | C++        | 1                 | 2                 | 1623              | 1820.31           | 197.31       |
| kurenai3110  | 930508.47  | 4    | 04.19.2018 10:23:35     | C++        | 2                 | 2                 | 2137              | 2190.03           | 53.03        |
| yowa         | 923135.59  | 5    | 04.19.2018 12:11:38     | C++        | 3                 | 3                 | 2157              | 2189.10           | 32.10        |
| CatalinT     | 893220.34  | 6    | 04.19.2018 04:55:27     | C++        | 3                 | 2                 | 2504              | 2477.67           | -26.33       |
| dimkadimon   | 884237.29  | 7    | 04.19.2018 08:00:41     | Java       | 2                 | 1                 | 1646              | 1739.77           | 93.77        |
| eris_c       | 871525.42  | 8    | 04.19.2018 11:38:48     | C++        | 2                 | 2                 | 1514              | 1841.79           | 327.79       |
| kimiyuki     | 870254.24  | 9    | 04.19.2018 05:04:49     | C++        | 9                 | 2                 | 1745              | 1830.07           | 85.07        |
| MaxBuzz      | 865254.24  | 10   | 04.19.2018 11:25:18     | Java       | 3                 | 2                 | 1393              | 1523.64           | 130.64       |

rejudgeがあった。[ceni1055](https://www.topcoder.com/members/ceni1055/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さん [Pag2](https://www.topcoder.com/members/Pag2/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんが同点1位だったがtesterのバグを突いてたようで共に0点に落ちていた。

`33ec0a8eb9474d17d67cb7ec7851e337ded45d0f` を提出。5位。
外側のものは残りやすいのでそれらを先に片付けて少数だけ残して決め打ちし、それら残りを集中的に乱択で処理する。

[kurenai3110](https://www.topcoder.com/members/kurenai3110/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さん [yowa](https://www.topcoder.com/members/yowa/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんが上にいる。まだ初日深夜だが彼らいつもこの時間にこんな順位なんだっけかという気持ち。
[shamai](https://www.topcoder.com/members/shamal/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さん [ebicochineal](https://www.topcoder.com/members/ebicochineal/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんがさらに上にいる。共にratingが未収束でなんとも言えないね。

| Handle        | Score       | Rank   | Last Submission Time      | Language    | Example Tests     | Submissions | Current Rating    | Predicted Rating  | Rating Delta |
|---------------|-------------|--------|---------------------------|-------------|-------------------|-------------|-------------------|-------------------|--------------|
| shamal        | 953560.61   | 1      | 04.19.2018 13:44:19       | C++         | 6                 | 3           | 1627              | 1901.85           | 274.85       |
| ebicochineal  | 942348.48   | 2      | 04.19.2018 13:10:29       | C++         | 1                 | 3           | 1623              | 1864.42           | 241.42       |
| kurenai3110   | 932500.00   | 3      | 04.19.2018 10:23:35       | C++         | 2                 | 2           | 2137              | 2213.70           | 76.70        |
| yowa          | 928560.61   | 4      | 04.19.2018 12:11:38       | C++         | 3                 | 3           | 2157              | 2205.63           | 48.63        |
| kimiyuki      | 923484.85   | 5      | 04.19.2018 14:00:26       | C++         | 11                | 3           | 1745              | 1896.23           | 151.23       |
| CatalinT      | 893636.36   | 6      | 04.19.2018 04:55:27       | C++         | 3                 | 2           | 2504              | 2480.71           | -23.29       |

![33ec0a8eb9474d17d67cb7ec7851e337ded45d0f](https://user-images.githubusercontent.com/2203128/39096790-5cc4845e-468f-11e8-869e-42d9bd14106b.gif)

次やるべきことは焼き鈍しに思える。
対の列と見ると焼けないが、対の集合から列の復元が実質的に一意であることを考えると焼ける。

### 4/19

対の集合から列の復元は単純には集合の大きさ k に対して O(k^2) 回の対の有効性判定。
愚直に停止するまでloopしても依存関係のグラフ作っても計算量としては変わらない。
盤面上に乗っているなどの対の性質や失敗したとき継続を作って判定再開可能だとかの有効性判定述語の性質を利用すれば実質 O(k) に落ちる。
O(k^2) 回の判定再開は発生するがこれは軽いので無視できる。

焼き鈍しでなくてもっと雑な修正山登りのようなものをした。いい感じに見えるけど悪化してるケースもあるっぽい？
そういえば前処理の後に座圧しておきたい。

色数が多い場合 C = 6 は初手で書いた愚直が強いっぽい。適当に分岐入れればいいのかな。改善がしにくくなるからまだensembleはしたくない気がするがここまで差があるとしかたがなさそう。

```
ef25d3886933e2460338d966f54db435e0213b88
1) 1.0
2) 1.0
3) 0.9688
4) 0.958758109360519
5) 0.9979919678714859
6) 1.0
7) 0.999244142101285
8) 0.9972789115646259
9) 1.0
10) 1.0
```

```
958cf1fba027bb94691c892443888a77bc1c9a41
1) 1.0
2) 1.0
3) 0.9108
4) 0.8220574606116775
5) 1.0
6) 1.0
7) 1.0
8) 1.0
9) 1.0
10) 1.0
```

そもそも円形にする前処理はどのくらい妥当なんだったっけ？

ensemble `5d9cb5c536e63d2122ac8c96f48db7e10556e2d5` 提出。同状況で 851188.12 -> 862970.30 の微増。渋くない？

|  Handle         | Score          | Rank   | Last Submission Time     | Language     | Example Tests  | Submissions   |
|-----------------|----------------|--------|--------------------------|--------------|----------------|---------------|
|  sdya           | 921683.17      | 1      | 04.19.2018 17:11:35      | C++          | 1              | 1             |
|  shamal         | 909257.43      | 2      | 04.19.2018 13:44:19      | C++          | 6              | 3             |
|  CatalinT       | 906336.63      | 3      | 04.20.2018 04:06:54      | C++          | 4              | 4             |
|  shilov         | 904851.49      | 4      | 04.20.2018 00:57:03      | Java         | 9              | 4             |
|  ebicochineal   | 900792.08      | 5      | 04.20.2018 00:17:27      | C++          | 1              | 5             |
|  iwashi31       | 894009.90      | 6      | 04.19.2018 19:47:30      | C++          | 2              | 2             |
|  gardn999       | 885594.06      | 7      | 04.20.2018 00:06:10      | Java         | 4              | 4             |
|  kurenai3110    | 884059.41      | 8      | 04.20.2018 00:40:08      | C++          | 3              | 3             |
|  JacoCronje     | 882326.73      | 9      | 04.19.2018 15:15:21      | C++          | 1              | 1             |
|  dimkadimon     | 868316.83      | 10     | 04.20.2018 02:26:05      | Java         | 4              | 3             |
|  cannab         | 866732.67      | 11     | 04.20.2018 01:51:06      | C++          | 2              | 2             |
|  ki-ki          | 865841.58      | 12     | 04.19.2018 20:35:18      | Java         | 3              | 3             |
|  kimiyuki       | 862970.30      | 13     | 04.20.2018 04:45:03      | C++          | 15             | 4             |

画像は `958cf1fba027bb94691c892443888a77bc1c9a41` のもの。

![958cf1fba027bb94691c892443888a77bc1c9a41](https://user-images.githubusercontent.com/2203128/39096793-5e879c9a-468f-11e8-8d71-124f533c0ada.gif)

rating predictorが壊れてたので直した。これ [#2](https://github.com/kmyk/topcoder-marathon-match-rating-predictor/issues/2) ひどくない？

消去可能判定のために双方向linked listを置いておくのはどうか。bitsetの方が良いかもだが。

手で遊んでみたが何も分からない。明らかに手動だと点数が出ない。
上下に隣接してたりするやつを優先的に消すとか、自明に消せるやつは置いておいて他の邪魔をしたときに始めて消すとか、そういうのがいい気がするがこれは人間固有な気もする。

末尾を消すのでなくて適当に間引くのはどうか。
対の集合からの列復元でしか山登りをしてないが、貪欲でも同様にできるのでは。

ensemble `5d9cb5c536e63d2122ac8c96f48db7e10556e2d5` で100個。
C = 2,3,4 はすべて満点を取れている。
C = 5 では満点は16個中4個。
C = 6 では全滅。

| seed  | C | score  |
|-------|---|--------|
| 1     | 2 | 1.0    |
| 2     | 4 | 1.0    |
| 3     | 6 | 0.9908 |
| 4     | 6 | 0.9782 |
| 5     | 4 | 1.0    |
| 6     | 4 | 1.0    |
| 7     | 3 | 1.0    |
| 8     | 4 | 1.0    |
| 9     | 3 | 1.0    |
| 10    | 2 | 1.0    |
| 11    | 5 | 0.9855 |
| 12    | 3 | 1.0    |
| 13    | 6 | 0.9875 |
| 14    | 6 | 0.9659 |
| 15    | 3 | 1.0    |
| 16    | 4 | 1.0    |
| 17    | 5 | 0.9777 |
| 18    | 5 | 0.9966 |
| 19    | 6 | 0.9306 |
| 20    | 2 | 1.0    |
| 21    | 3 | 1.0    |
| 22    | 6 | 0.9842 |
| 23    | 2 | 1.0    |
| 24    | 6 | 0.9753 |
| 25    | 3 | 1.0    |
| 26    | 5 | 1.0    |
| 27    | 4 | 1.0    |
| 28    | 2 | 1.0    |
| 29    | 2 | 1.0    |
| 30    | 5 | 0.9975 |
| 31    | 6 | 0.9925 |
| 32    | 4 | 1.0    |
| 33    | 6 | 0.9822 |
| 34    | 4 | 1.0    |
| 35    | 3 | 1.0    |
| 36    | 2 | 1.0    |
| 37    | 6 | 0.9801 |
| 38    | 4 | 1.0    |
| 39    | 3 | 1.0    |
| 40    | 3 | 1.0    |
| 41    | 2 | 1.0    |
| 42    | 3 | 1.0    |
| 43    | 6 | 0.9883 |
| 44    | 2 | 1.0    |
| 45    | 4 | 1.0    |
| 46    | 2 | 1.0    |
| 47    | 5 | 1.0    |
| 48    | 5 | 1.0    |
| 49    | 2 | 1.0    |
| 50    | 6 | 0.9875 |
| 51    | 3 | 1.0    |
| 52    | 2 | 1.0    |
| 53    | 6 | 0.9833 |
| 54    | 3 | 1.0    |
| 55    | 3 | 1.0    |
| 56    | 4 | 1.0    |
| 57    | 6 | 0.9647 |
| 58    | 6 | 0.9592 |
| 59    | 2 | 1.0    |
| 60    | 3 | 1.0    |
| 61    | 2 | 1.0    |
| 62    | 5 | 0.9927 |
| 63    | 4 | 1.0    |
| 64    | 5 | 1.0    |
| 65    | 3 | 1.0    |
| 66    | 4 | 1.0    |
| 67    | 2 | 1.0    |
| 68    | 5 | 0.9780 |
| 69    | 4 | 1.0    |
| 70    | 5 | 0.9961 |
| 71    | 4 | 1.0    |
| 72    | 5 | 0.9852 |
| 73    | 5 | 0.9984 |
| 74    | 2 | 1.0    |
| 75    | 3 | 1.0    |
| 76    | 3 | 1.0    |
| 77    | 3 | 1.0    |
| 78    | 4 | 1.0    |
| 79    | 2 | 1.0    |
| 80    | 2 | 1.0    |
| 81    | 5 | 0.9986 |
| 82    | 6 | 0.9823 |
| 83    | 3 | 1.0    |
| 84    | 2 | 1.0    |
| 85    | 3 | 1.0    |
| 86    | 4 | 1.0    |
| 87    | 4 | 1.0    |
| 88    | 5 | 0.9949 |
| 89    | 3 | 1.0    |
| 90    | 4 | 1.0    |
| 91    | 6 | 0.9894 |
| 92    | 2 | 1.0    |
| 93    | 2 | 1.0    |
| 94    | 4 | 1.0    |
| 95    | 3 | 1.0    |
| 96    | 3 | 1.0    |
| 97    | 3 | 1.0    |
| 98    | 4 | 1.0    |
| 99    | 6 | 0.9833 |
| 100   | 5 | 0.9946 |


変なことするの止めて貪欲と修正の繰り返しにしたら良くなった。
`06df28f97a648764adfd1e1aff41f4acaa9a6393` 提出。
暫定2位で驚き。
完全にラッキーパンチ。よく分からないまま上がったということは後はいつものように下がるだけになるので困る。
この単純さだとどうせみんな辿り着くよなあという気持ち。コードが短かくなったのは嬉しいが。

| Handle      | Score     | Rank      | Last Submission Time  | Language  | Example Tests   | Submissions     | Current Rating  | Predicted Rating      | Rating Delta |
|-------------|-----------|-----------|-----------------------|-----------|-----------------|-----------------|-----------------|-----------------------|--------------|
| sdya        | 918782.61 | 1         | 04.19.2018 17:11:35   | C++       | 1               | 1               | 2163            | 2317.20               | 154.20       |
| kimiyuki    | 909260.87 | 2         | 04.20.2018 08:54:18   | C++       | 16              | 5               | 1745            | 2021.32               | 276.32       |
| shamal      | 903304.35 | 3         | 04.19.2018 13:44:19   | C++       | 6               | 3               | 1627            | 1856.56               | 229.56       |
| shilov      | 900826.09 | 4         | 04.20.2018 00:57:03   | Java      | 9               | 4               | 985             | 1190.56               | 205.56       |
| CatalinT    | 900695.65 | 5         | 04.20.2018 04:06:54   | C++       | 4               | 4               | 2504            | 2511.47               | 7.47         |

![06df28f97a648764adfd1e1aff41f4acaa9a6393](https://user-images.githubusercontent.com/2203128/39096794-60e3d1ca-468f-11e8-8ddc-ae9d8394e05d.gif)

C = 5 の場合もすべて満点が出ている。C = 2,3,4 の場合も満点なので省略している。
最終的に全完もありえるように思えてきた。

| seed  | C | score  |
|-------|---|--------|
| 3     | 6 | 0.9962 |
| 4     | 6 | 0.9898 |
| 11    | 5 | 1.0    |
| 13    | 6 | 0.9951 |
| 14    | 6 | 1.0    |
| 17    | 5 | 1.0    |
| 18    | 5 | 1.0    |
| 19    | 6 | 0.9760 |
| 22    | 6 | 0.9931 |
| 24    | 6 | 0.9942 |
| 26    | 5 | 1.0    |
| 30    | 5 | 1.0    |
| 31    | 6 | 0.9922 |
| 33    | 6 | 0.9921 |
| 37    | 6 | 0.9928 |
| 43    | 6 | 0.9955 |
| 47    | 5 | 1.0    |
| 48    | 5 | 1.0    |
| 50    | 6 | 0.9886 |
| 53    | 6 | 0.9966 |
| 57    | 6 | 0.9898 |
| 58    | 6 | 0.9905 |
| 62    | 5 | 1.0    |
| 64    | 5 | 1.0    |
| 68    | 5 | 1.0    |
| 70    | 5 | 1.0    |
| 72    | 5 | 1.0    |
| 73    | 5 | 1.0    |
| 81    | 5 | 1.0    |
| 82    | 6 | 0.9987 |
| 88    | 5 | 1.0    |
| 91    | 6 | 0.9952 |
| 99    | 6 | 0.9907 |
| 100   | 5 | 1.0    |

実行時間を10倍にした場合。
良くなってはいるがあまり効いてない。

| seed  | 9 sec  | 90 sec  |
|-------|--------|---------|
| 3     | 0.9962 | 0.9992  |
| 4     | 0.9898 | 0.9939  |
| 13    | 0.9951 | 0.9978  |
| 14    | 1.0    | 1.0     |
| 19    | 0.9760 | 0.9866  |
| 22    | 0.9931 | 0.9938  |
| 24    | 0.9942 | 0.9956  |
| 31    | 0.9922 | 0.9957  |
| 33    | 0.9921 | 0.9980  |
| 37    | 0.9928 | 0.9976  |
| 43    | 0.9955 | 0.9979  |
| 50    | 0.9886 | 0.9977  |
| 53    | 0.9966 | 0.9987  |
| 57    | 0.9898 | 0.9937  |
| 58    | 0.9905 | 0.9937  |
| 82    | 0.9987 | 0.9968  |
| 91    | 0.9952 | 0.9984  |
| 99    | 0.9907 | 0.9972  |


`271521042ab7e8b8fe5b6b79dff4916ff8c6c1da` ちゃんとした焼き鈍し。
結局いつもの思考停止焼き鈍しになってしまったなあという気持ち。

| seed  | random | HC     | SA     |
|-------|--------|--------|--------|
| 3     | 0.9962 | 0.9988 | 0.9980 |
| 4     | 0.9898 | 0.9967 | 0.9888 |
| 13    | 0.9951 | 0.9918 | 0.9972 |
| 14    | 1.0    | 0.9886 | 1.0    |
| 19    | 0.9760 | 0.9813 | 1.0    |
| 22    | 0.9931 | 0.9965 | 0.9986 |
| 24    | 0.9942 | 0.9681 | 1.0    |
| 31    | 0.9922 | 0.9943 | 0.9918 |
| 33    | 0.9921 | 0.9960 | 1.0    |
| 37    | 0.9928 | 0.9960 | 1.0    |
| 43    | 0.9955 | 0.9919 | 0.9975 |
| 50    | 0.9886 | 1.0    | 0.9977 |
| 53    | 0.9966 | 0.9959 | 0.9946 |
| 57    | 0.9898 | 0.9937 | 0.9945 |
| 58    | 0.9905 | 0.9874 | 1.0    |
| 82    | 0.9987 | 0.9968 | 0.9974 |
| 91    | 0.9952 | 0.9973 | 1.0    |
| 99    | 0.9907 | 0.9926 | 0.9944 |

同様に制限時間を伸ばした場合。SAは速度の改善が十分有効のようだ。

| seed  | 9 sec  | 90 sec |
|-------|--------|--------|
| 3     | 0.9980 | 0.9992 |
| 4     | 0.9888 | 1.0    |
| 13    | 0.9972 | 1.0    |
| 14    | 1.0    | 1.0    |
| 19    | 1.0    | 1.0    |
| 22    | 0.9986 | 1.0    |
| 24    | 1.0    | 1.0    |
| 31    | 0.9918 | 0.9992 |
| 33    | 1.0    | 1.0    |
| 37    | 1.0    | 1.0    |
| 43    | 0.9975 | 1.0    |
| 50    | 0.9977 | 1.0    |
| 53    | 0.9946 | 0.9984 |
| 57    | 0.9945 | 1.0    |
| 58    | 1.0    | 1.0    |
| 82    | 0.9974 | 1.0    |
| 91    | 1.0    | 0.9986 |
| 99    | 0.9944 | 1.0    |

次に複数回試行した結果。ばらつくようなら初期解への依存が大きいなどが言えるだろうと思ったが、いまいちよく分からない結果。

| seed | A      | B      | C      | D      | E      | F      | G      | H      | I      | J      |
|------|--------|--------|--------|--------|--------|--------|--------|--------|--------|--------|
| 3    | 0.998  | 0.9976 | 0.9972 | 0.9984 | 0.9982 | 0.998  | 0.9974 | 0.9968 | 0.9956 | 0.997  |
| 4    | 0.9958 | 0.9930 | 0.9972 | 0.9958 | 0.9953 | 0.9939 | 0.9925 | 0.9916 | 0.9925 | 0.9953 |
| 13   | 0.9989 | 0.9956 | 0.9967 | 0.9983 | 0.9978 | 1.0    | 0.9935 | 0.9972 | 0.9983 | 0.9945 |
| 14   | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    |
| 19   | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    |
| 22   | 0.9945 | 0.9890 | 0.9938 | 0.9951 | 0.9986 | 0.9855 | 1.0    | 0.9965 | 0.9938 | 0.9972 |
| 24   | 0.9971 | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 0.9956 | 1.0    | 1.0    | 0.9971 |
| 31   | 0.9964 | 0.9876 | 0.9943 | 0.9922 | 0.9940 | 0.9922 | 0.9901 | 0.9947 | 0.9943 | 0.9975 |
| 33   | 0.9970 | 1.0    | 0.9940 | 1.0    | 0.9931 | 0.9980 | 0.9970 | 1.0    | 1.0    | 1.0    |
| 37   | 1.0    | 1.0    | 0.9976 | 0.9960 | 1.0    | 0.9976 | 1.0    | 1.0    | 0.9984 | 0.9976 |
| 43   | 0.9963 | 0.9899 | 0.9919 | 0.9971 | 1.0    | 0.9963 | 0.9919 | 0.9971 | 0.9971 | 0.9903 |
| 50   | 0.9954 | 0.9965 | 1.0    | 1.0    | 1.0    | 0.9977 | 1.0    | 1.0    | 1.0    | 1.0    |
| 53   | 0.9984 | 0.9969 | 0.9976 | 0.9994 | 0.9918 | 0.9987 | 0.9979 | 0.9969 | 0.9966 | 0.9948 |
| 57   | 0.9952 | 0.9945 | 1.0    | 1.0    | 0.9945 | 0.9976 | 0.9968 | 0.9913 | 0.9913 | 0.9984 |
| 58   | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    | 1.0    |
| 82   | 0.9987 | 1.0    | 0.9962 | 1.0    | 0.9968 | 0.9962 | 1.0    | 1.0    | 0.9987 | 0.9962 |
| 91   | 0.9986 | 0.9992 | 0.9986 | 0.9984 | 0.9962 | 1.0    | 0.9981 | 0.9986 | 0.9931 | 0.9984 |
| 99   | 1.0    | 0.9981 | 1.0    | 0.9972 | 1.0    | 0.9981 | 1.0    | 1.0    | 0.9972 | 0.9916 |

`271521042ab7e8b8fe5b6b79dff4916ff8c6c1da` の提出結果。 903445.38 -> 910336.13 と改善はしているが順位は変わらず。
解法の自明さと点数の近さから見て、 [sdya](https://www.topcoder.com/members/sdya/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんも [shamal](https://www.topcoder.com/members/shamal/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんも解法は私とほぼ同じに思える。

1位取ったつもりで投げたのに全然だめで冷えた。
ほぼなかった満点の数が半分くらいになったし「単独1位だろうから順位表を見れば「どうせあいつのことだから思考停止焼き鈍し/ビームサーチでラッキーパンチでしょ」というメタができてしまう気がする提出控えた方がいいかなあ」「でも暫定1位にして気持ちよくなりたい」などと考えていたのはなんだったのか、悲しすぎる。

[kurenai3110](https://www.topcoder.com/members/kurenai3110/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんや [yowa](https://www.topcoder.com/members/yowa/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんがまだ下の方なのはなぜだろう。そろそろ彼らが1,2位あたりに座る頃の印象がある。
[wleite](https://www.topcoder.com/members/wleite/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんや [hakomo](https://www.topcoder.com/members/hakomo/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんあたりの初動が遅いのはこれはいつもそうだった気がする。

| Handle     | Score     | Rank      | Last Submission Time     | Language  | Example Tests  | Submissions    | Current Rating | Predicted Rating    | Rating Delta |
|------------|-----------|-----------|--------------------------|-----------|----------------|----------------|----------------|---------------------|--------------|
| sdya       | 913445.38 | 1         | 04.19.2018 17:11:35      | C++       | 1              | 1              | 2163           | 2319.33             | 156.33       |
| shamal     | 910798.32 | 2         | 04.20.2018 09:10:22      | C++       | 7              | 4              | 1627           | 1897.04             | 270.04       |
| kimiyuki   | 910336.13 | 3         | 04.20.2018 10:57:17      | C++       | 19             | 6              | 1745           | 1982.81             | 237.81       |
| JacoCronje | 902647.06 | 4         | 04.20.2018 08:59:33      | C++       | 3              | 3              | 2231           | 2287.71             | 56.71        |
| CatalinT   | 894327.73 | 5         | 04.20.2018 04:06:54      | C++       | 4              | 4              | 2504           | 2512.00             | 8.00         |

![271521042ab7e8b8fe5b6b79dff4916ff8c6c1da](https://user-images.githubusercontent.com/2203128/39096795-62ec9e20-468f-11e8-904e-ee98bcc4a2bb.gif)

次の手はとりあえず高速化と焼き鈍し変数調整だろうか。しかし日程を見ても解法を見てもそういうのはまだ早い気がする。どうしたものか。

seedごとの点数のばらつきの原因は何だろうか。
観察すると盤面の大小に起因する試行回数の多寡が原因に見える。
近傍の取り方や削除可能判定の高速化を上手くやれば改善になると考えられる。
ところでscoreでなくて残りマス数を出力させた方がよいですね。分かりやすく相関がある。

| seed | size  | remaining |
|------|-------|-----------|
| 3    | 10000 |        20 |
| 4    | 4316  |        64 |
| 13   | 3698  |        24 |
| 14   | 352   |         0 |
| 19   | 750   |         0 |
| 22   | 2916  |        18 |
| 24   | 1380  |         0 |
| 31   | 5670  |        18 |
| 33   | 2030  |         0 |
| 37   | 2520  |        10 |
| 43   | 4970  |        24 |
| 50   | 1760  |         0 |
| 53   | 7812  |        26 |
| 57   | 2550  |        12 |
| 58   | 638   |         0 |
| 82   | 3174  |         0 |
| 91   | 7566  |        18 |
| 99   | 2166  |         0 |

`4b22cdec745fa64be3fe8dc31c160f9978f4dd5b`。
近傍の取り方と削除可能判定の高速化をした。
焼き鈍しの遷移確率にバグがあったので修正した。

| seed | size  | remaining |
|------|-------|-----------|
| 3    | 10000 |        0  |
| 4    | 4316  |        16 |
| 13   | 3698  |        0  |
| 14   | 352   |        0  |
| 19   | 750   |        0  |
| 22   | 2916  |        0  |
| 24   | 1380  |        0  |
| 31   | 5670  |        18 |
| 33   | 2030  |        6  |
| 37   | 2520  |        0  |
| 43   | 4970  |        6  |
| 50   | 1760  |        0  |
| 53   | 7812  |        34 |
| 57   | 2550  |        8  |
| 58   | 638   |        0  |
| 82   | 3174  |        0  |
| 91   | 7566  |        0  |
| 99   | 2166  |        6  |

微増。
902834.65 -> 904370.08。
もうかなり限界のはずだが 0.90e6 点しかないのなんでかなあと思ったが、同点だと半分なのですべて満点でも 1e6 になるわけではないし不思議ではなかった。
ところでこのまま終了すればrating 300増えるというのは本当なのだろうか。

| Handle    | Score          | Rank | Last Submission Time     | Language  | Example Tests  | Submissions    | Current Rating      | Predicted Rating    | Rating Delta |
|-----------|----------------|------|--------------------------|-----------|----------------|----------------|---------------------|---------------------|--------------|
| sdya      | 905354.33      | 1    | 04.19.2018 17:11:35      | C++       | 1              | 1              | 2163                | 2331.08             | 168.08       |
| kimiyuki  | 904370.08      | 2    | 04.20.2018 14:24:04      | C++       | 21             | 7              | 1745                | 2042.50             | 297.50       |
| shamal    | 902480.31      | 3    | 04.20.2018 09:10:22      | C++       | 7              | 4              | 1627                | 1874.48             | 247.48       |

![4b22cdec745fa64be3fe8dc31c160f9978f4dd5b](https://user-images.githubusercontent.com/2203128/39096798-664dcecc-468f-11e8-8d75-277f5c404817.gif)

### 4/21

なんだか問題自体がSATっぽい雰囲気がある。
全部走って行き止まるまで失敗かどうか分からない点とかがそう。
ビームサーチができない。
SATは変数の決定の順序が重要で頻繁にrestartをするが、現在の戦略もなんとなくこれに近い。
となるともっと陽に矛盾からの学習をしてみるのはどうか。
つまり他のマスを犠牲にし最後に残ったマスがすべて消えるように修正するような遷移を入れる。
でもこれ修正の方法それ自体が難しいので難しい。

`vector<vector<int> >` を `vector<int>` にすると速くなるはず。特にTopCoderの鯖上で効く。あとでやる。

なぜ `958cf1fba027bb94691c892443888a77bc1c9a41` あたりの解法が失敗していたのだろうか。
円形に前処理し、座圧、末尾をいじる感じの遷移の繰り返しをしていた。
面積と点数の相関も未だ残っているように見える (要確認)。なぜすべて解消されないのか。
雑な前処理だと面倒臭いマスが残るからだろうか。
ここから考えるに、盤面を分割して区分的にやるのが選択肢になりそう。

### 4/21 24:00 ~

同 `4b22cdec745fa64be3fe8dc31c160f9978f4dd5b` でもっとたくさん試した。C < 6 はすべて満点。
area で整列すると remaining との相関が感じられる。
ところで github の readme.md って上手く折り畳み機能とかないのかな。折り畳みはさすがにないにしても、 issue では使える permalink を展開していい感じにコード埋め込んでくれるやつとか欲しいんだけど。

| seed    | H     | W     | C     | remaining | area  |
|---------|-------|-------|-------|-----------|-------|
| 3       | 100   | 100   | 6     | 18        | 10000 |
| 4       | 52    | 83    | 6     | 52        | 4316  |
| 13      | 86    | 43    | 6     | 4         | 3698  |
| 14      | 16    | 22    | 6     | 0         | 352   |
| 19      | 75    | 10    | 6     | 0         | 750   |
| 22      | 54    | 54    | 6     | 6         | 2916  |
| 24      | 30    | 46    | 6     | 4         | 1380  |
| 31      | 63    | 90    | 6     | 0         | 5670  |
| 33      | 29    | 70    | 6     | 0         | 2030  |
| 37      | 45    | 56    | 6     | 0         | 2520  |
| 43      | 70    | 71    | 6     | 12        | 4970  |
| 50      | 40    | 44    | 6     | 0         | 1760  |
| 53      | 93    | 84    | 6     | 10        | 7812  |
| 57      | 30    | 85    | 6     | 8         | 2550  |
| 58      | 29    | 22    | 6     | 0         | 638   |
| 82      | 46    | 69    | 6     | 8         | 3174  |
| 91      | 97    | 78    | 6     | 6         | 7566  |
| 99      | 38    | 57    | 6     | 0         | 2166  |
| 105     | 22    | 94    | 6     | 20        | 2068  |
| 113     | 93    | 92    | 6     | 14        | 8556  |
| 116     | 18    | 93    | 6     | 12        | 1674  |
| 123     | 23    | 54    | 6     | 28        | 1242  |
| 125     | 48    | 89    | 6     | 10        | 4272  |
| 134     | 51    | 54    | 6     | 4         | 2754  |
| 136     | 28    | 69    | 6     | 0         | 1932  |
| 142     | 47    | 12    | 6     | 0         | 564   |
| 143     | 32    | 67    | 6     | 0         | 2144  |
| 154     | 75    | 34    | 6     | 0         | 2550  |
| 166     | 22    | 42    | 6     | 12        | 924   |
| 177     | 85    | 46    | 6     | 0         | 3910  |
| 184     | 16    | 35    | 6     | 0         | 560   |
| 187     | 85    | 78    | 6     | 4         | 6630  |
| 196     | 100   | 77    | 6     | 26        | 7700  |
| 198     | 86    | 36    | 6     | 16        | 3096  |
| 199     | 18    | 74    | 6     | 20        | 1332  |
| 201     | 15    | 54    | 6     | 0         | 810   |
| 215     | 89    | 38    | 6     | 14        | 3382  |
| 221     | 91    | 64    | 6     | 8         | 5824  |
| 227     | 14    | 81    | 6     | 8         | 1134  |
| 228     | 62    | 41    | 6     | 8         | 2542  |
| 229     | 18    | 59    | 6     | 0         | 1062  |
| 236     | 42    | 42    | 6     | 10        | 1764  |
| 243     | 75    | 52    | 6     | 6         | 3900  |
| 259     | 36    | 72    | 6     | 0         | 2592  |
| 268     | 32    | 16    | 6     | 0         | 512   |
| 273     | 10    | 59    | 6     | 6         | 590   |
| 281     | 63    | 60    | 6     | 0         | 3780  |
| 282     | 64    | 73    | 6     | 0         | 4672  |
| 288     | 78    | 88    | 6     | 4         | 6864  |
| 303     | 97    | 88    | 6     | 16        | 8536  |
| 321     | 85    | 34    | 6     | 14        | 2890  |
| 327     | 70    | 64    | 6     | 0         | 4480  |
| 328     | 100   | 53    | 6     | 24        | 5300  |
| 330     | 78    | 69    | 6     | 0         | 5382  |
| 335     | 93    | 36    | 6     | 26        | 3348  |
| 336     | 21    | 84    | 6     | 0         | 1764  |
| 341     | 67    | 98    | 6     | 6         | 6566  |
| 343     | 39    | 98    | 6     | 24        | 3822  |
| 347     | 60    | 29    | 6     | 0         | 1740  |
| 352     | 15    | 20    | 6     | 0         | 300   |
| 354     | 74    | 39    | 6     | 0         | 2886  |
| 362     | 37    | 34    | 6     | 0         | 1258  |
| 371     | 88    | 41    | 6     | 4         | 3608  |
| 373     | 76    | 34    | 6     | 8         | 2584  |
| 377     | 78    | 71    | 6     | 0         | 5538  |
| 380     | 65    | 60    | 6     | 24        | 3900  |
| 381     | 50    | 31    | 6     | 0         | 1550  |
| 384     | 10    | 43    | 6     | 4         | 430   |
| 385     | 54    | 57    | 6     | 0         | 3078  |
| 392     | 100   | 77    | 6     | 0         | 7700  |
| 400     | 32    | 63    | 6     | 0         | 2016  |
| 401     | 58    | 21    | 6     | 4         | 1218  |
| 411     | 17    | 20    | 6     | 0         | 340   |
| 413     | 80    | 17    | 6     | 10        | 1360  |
| 414     | 22    | 47    | 6     | 0         | 1034  |
| 416     | 96    | 23    | 6     | 70        | 2208  |
| 422     | 50    | 96    | 6     | 10        | 4800  |
| 430     | 90    | 83    | 6     | 12        | 7470  |
| 431     | 88    | 40    | 6     | 18        | 3520  |
| 432     | 12    | 68    | 6     | 0         | 816   |
| 443     | 68    | 75    | 6     | 16        | 5100  |
| 445     | 28    | 70    | 6     | 0         | 1960  |
| 446     | 90    | 19    | 6     | 0         | 1710  |
| 448     | 46    | 43    | 6     | 4         | 1978  |
| 451     | 40    | 48    | 6     | 12        | 1920  |
| 455     | 74    | 39    | 6     | 12        | 2886  |
| 457     | 23    | 18    | 6     | 0         | 414   |
| 459     | 34    | 91    | 6     | 8         | 3094  |
| 461     | 66    | 90    | 6     | 0         | 5940  |
| 466     | 93    | 92    | 6     | 4         | 8556  |
| 467     | 54    | 67    | 6     | 10        | 3618  |
| 472     | 83    | 72    | 6     | 8         | 5976  |
| 475     | 88    | 35    | 6     | 8         | 3080  |
| 476     | 84    | 32    | 6     | 40        | 2688  |
| 478     | 78    | 34    | 6     | 0         | 2652  |
| 483     | 33    | 30    | 6     | 0         | 990   |
| 484     | 27    | 70    | 6     | 12        | 1890  |
| 485     | 24    | 36    | 6     | 0         | 864   |
| 487     | 69    | 22    | 6     | 10        | 1518  |
| 489     | 88    | 77    | 6     | 0         | 6776  |
| 490     | 94    | 55    | 6     | 4         | 5170  |
| 492     | 52    | 85    | 6     | 10        | 4420  |
| 494     | 61    | 20    | 6     | 0         | 1220  |
| 500     | 30    | 87    | 6     | 0         | 2610  |
| 507     | 56    | 28    | 6     | 0         | 1568  |
| 508     | 56    | 97    | 6     | 16        | 5432  |
| 515     | 76    | 30    | 6     | 14        | 2280  |
| 516     | 36    | 36    | 6     | 0         | 1296  |
| 521     | 52    | 11    | 6     | 0         | 572   |
| 528     | 92    | 44    | 6     | 0         | 4048  |
| 530     | 71    | 54    | 6     | 20        | 3834  |
| 535     | 14    | 67    | 6     | 0         | 938   |
| 542     | 13    | 48    | 6     | 4         | 624   |
| 543     | 77    | 58    | 6     | 46        | 4466  |
| 555     | 18    | 29    | 6     | 0         | 522   |
| 569     | 78    | 11    | 6     | 0         | 858   |
| 572     | 25    | 66    | 6     | 0         | 1650  |
| 573     | 44    | 57    | 6     | 16        | 2508  |
| 586     | 51    | 34    | 6     | 8         | 1734  |
| 593     | 50    | 67    | 6     | 12        | 3350  |
| 617     | 46    | 91    | 6     | 12        | 4186  |
| 619     | 73    | 16    | 6     | 4         | 1168  |
| 622     | 62    | 77    | 6     | 18        | 4774  |
| 627     | 92    | 76    | 6     | 0         | 6992  |
| 629     | 32    | 37    | 6     | 12        | 1184  |
| 630     | 40    | 13    | 6     | 0         | 520   |
| 631     | 92    | 40    | 6     | 8         | 3680  |
| 633     | 71    | 82    | 6     | 6         | 5822  |
| 640     | 18    | 88    | 6     | 22        | 1584  |
| 654     | 53    | 66    | 6     | 32        | 3498  |
| 657     | 60    | 81    | 6     | 0         | 4860  |
| 658     | 77    | 22    | 6     | 10        | 1694  |
| 667     | 59    | 86    | 6     | 26        | 5074  |
| 671     | 70    | 36    | 6     | 18        | 2520  |
| 691     | 79    | 74    | 6     | 4         | 5846  |
| 699     | 62    | 77    | 6     | 16        | 4774  |
| 701     | 66    | 25    | 6     | 0         | 1650  |
| 713     | 52    | 22    | 6     | 6         | 1144  |
| 718     | 64    | 63    | 6     | 8         | 4032  |
| 725     | 87    | 98    | 6     | 12        | 8526  |
| 727     | 18    | 72    | 6     | 6         | 1296  |
| 733     | 76    | 65    | 6     | 0         | 4940  |
| 737     | 17    | 48    | 6     | 0         | 816   |
| 744     | 56    | 65    | 6     | 0         | 3640  |
| 752     | 58    | 64    | 6     | 8         | 3712  |
| 755     | 100   | 91    | 6     | 0         | 9100  |
| 762     | 50    | 15    | 6     | 4         | 750   |
| 765     | 32    | 39    | 6     | 4         | 1248  |
| 771     | 26    | 95    | 6     | 18        | 2470  |
| 774     | 11    | 30    | 6     | 0         | 330   |
| 781     | 77    | 30    | 6     | 6         | 2310  |
| 784     | 89    | 38    | 6     | 16        | 3382  |
| 787     | 23    | 88    | 6     | 4         | 2024  |
| 790     | 64    | 72    | 6     | 0         | 4608  |
| 803     | 29    | 26    | 6     | 0         | 754   |
| 809     | 93    | 62    | 6     | 8         | 5766  |
| 814     | 100   | 51    | 6     | 4         | 5100  |
| 818     | 62    | 83    | 6     | 0         | 5146  |
| 843     | 91    | 100   | 6     | 0         | 9100  |
| 845     | 98    | 42    | 6     | 8         | 4116  |
| 853     | 45    | 22    | 6     | 0         | 990   |
| 854     | 18    | 55    | 6     | 0         | 990   |
| 858     | 34    | 96    | 6     | 10        | 3264  |
| 870     | 86    | 42    | 6     | 26        | 3612  |
| 876     | 97    | 66    | 6     | 10        | 6402  |
| 879     | 77    | 54    | 6     | 6         | 4158  |
| 881     | 22    | 53    | 6     | 0         | 1166  |
| 882     | 25    | 64    | 6     | 0         | 1600  |
| 884     | 94    | 68    | 6     | 20        | 6392  |
| 886     | 15    | 10    | 6     | 6         | 150   |
| 892     | 74    | 49    | 6     | 16        | 3626  |
| 900     | 86    | 48    | 6     | 26        | 4128  |
| 905     | 87    | 26    | 6     | 22        | 2262  |
| 909     | 36    | 48    | 6     | 0         | 1728  |
| 911     | 52    | 72    | 6     | 22        | 3744  |
| 927     | 86    | 29    | 6     | 22        | 2494  |
| 935     | 39    | 28    | 6     | 0         | 1092  |
| 943     | 14    | 48    | 6     | 0         | 672   |
| 952     | 61    | 24    | 6     | 0         | 1464  |
| 956     | 94    | 33    | 6     | 8         | 3102  |
| 958     | 11    | 90    | 6     | 10        | 990   |
| 959     | 52    | 94    | 6     | 8         | 4888  |
| 962     | 19    | 52    | 6     | 0         | 988   |
| 976     | 55    | 14    | 6     | 6         | 770   |
| 980     | 56    | 63    | 6     | 0         | 3528  |
| 981     | 44    | 79    | 6     | 24        | 3476  |
| 988     | 60    | 61    | 6     | 0         | 3660  |
| 995     | 37    | 94    | 6     | 0         | 3478  |
| 997     | 16    | 22    | 6     | 0         | 352   |
| 998     | 35    | 100   | 6     | 6         | 3500  |
| 999     | 46    | 87    | 6     | 30        | 4002  |

`38e44646947e13968b4fb7388a747c4f63f5718f` 提出。
860575.76 -> 870333.33 と改善し2位に。
そろそろ1度くらい暫定1位ください。
こんなに運良くクリティカル入り続けるの滅多にないし勢いでどうか頼む。
もう落ちるしかないし潜伏が怖い。
特にExample Testsに1提出だけして点数nullで潜んでる [hakomo](https://www.topcoder.com/members/hakomo/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さん不穏すぎる。
丁寧に細かい改善を実装する感じだから青や緑が飛んでくる可能性もあるし。

変更点としてはまず区分的に解いた。
区分的に解くときに隣接する区画のゴミをついでに掃除してもらうやつも入れた。
さらに安定性の向上のため焼き鈍し中にrestartのようなものを入れた。
restartはSATと違ってすべて捨てて真に0からだがその代わりに採用は確率的。
順位表と比較は以下の図。

| Handle           | Score          | Rank      | Last Submission Time     | Language  | Example Tests  | Submissions    | Current Rating | Predicted Rating    | Rating Delta |
|------------------|----------------|-----------|--------------------------|-----------|----------------|----------------|----------------|---------------------|--------------|
| eldidou          | 870818.18      | 1         | 04.21.2018 11:45:08      | C++       | 3              | 2              | 2560           | 2669.98             | 109.98       |
| kimiyuki         | 870333.33      | 2         | 04.21.2018 15:33:40      | C++       | 22             | 8              | 1745           | 2054.80             | 309.80       |
| AlexeyProkopnev  | 865909.09      | 3         | 04.21.2018 13:07:58      | C++       | 18             | 10             | 1520           | 1758.56             | 238.56       |

![38e44646947e13968b4fb7388a747c4f63f5718f](https://user-images.githubusercontent.com/2203128/39096799-68f271b4-468f-11e8-8701-986ee63f2b3f.gif)

| seed    | H     | W     | C     | area   | base     | + piecewise | + restart |
|---------|-------|-------|-------|--------|----------|-------------|-----------|
| 3       | 100   | 100   | 6     | 10000  | 18       | 0           | 0         |
| 4       | 52    | 83    | 6     | 4316   | 52       | 0           | 0         |
| 13      | 86    | 43    | 6     | 3698   | 4        | 24          | 0         |
| 14      | 16    | 22    | 6     | 352    | 0        | 0           | 0         |
| 19      | 75    | 10    | 6     | 750    | 0        | 0           | 0         |
| 22      | 54    | 54    | 6     | 2916   | 6        | 14          | 0         |
| 24      | 30    | 46    | 6     | 1380   | 4        | 0           | 0         |
| 31      | 63    | 90    | 6     | 5670   | 0        | 0           | 0         |
| 33      | 29    | 70    | 6     | 2030   | 0        | 0           | 0         |
| 37      | 45    | 56    | 6     | 2520   | 0        | 0           | 0         |
| 43      | 70    | 71    | 6     | 4970   | 12       | 4           | 0         |
| 50      | 40    | 44    | 6     | 1760   | 0        | 0           | 0         |
| 53      | 93    | 84    | 6     | 7812   | 10       | 0           | 28        |
| 57      | 30    | 85    | 6     | 2550   | 8        | 0           | 4         |
| 58      | 29    | 22    | 6     | 638    | 0        | 0           | 0         |
| 82      | 46    | 69    | 6     | 3174   | 8        | 0           | 0         |
| 91      | 97    | 78    | 6     | 7566   | 6        | 0           | 0         |
| 99      | 38    | 57    | 6     | 2166   | 0        | 4           | 0         |
| 105     | 22    | 94    | 6     | 2068   | 20       | 8           | 0         |
| 113     | 93    | 92    | 6     | 8556   | 14       | 0           | 0         |
| 116     | 18    | 93    | 6     | 1674   | 12       | 0           | 0         |
| 123     | 23    | 54    | 6     | 1242   | 28       | 0           | 0         |
| 125     | 48    | 89    | 6     | 4272   | 10       | 0           | 10        |
| 134     | 51    | 54    | 6     | 2754   | 4        | 0           | 0         |
| 136     | 28    | 69    | 6     | 1932   | 0        | 0           | 0         |
| 142     | 47    | 12    | 6     | 564    | 0        | 42          | 0         |
| 143     | 32    | 67    | 6     | 2144   | 0        | 0           | 0         |
| 154     | 75    | 34    | 6     | 2550   | 0        | 0           | 0         |
| 166     | 22    | 42    | 6     | 924    | 12       | 0           | 0         |
| 177     | 85    | 46    | 6     | 3910   | 0        | 0           | 4         |
| 184     | 16    | 35    | 6     | 560    | 0        | 0           | 0         |
| 187     | 85    | 78    | 6     | 6630   | 4        | 4           | 0         |
| 196     | 100   | 77    | 6     | 7700   | 26       | 0           | 0         |
| 198     | 86    | 36    | 6     | 3096   | 16       | 0           | 0         |
| 199     | 18    | 74    | 6     | 1332   | 20       | 0           | 0         |
| 201     | 15    | 54    | 6     | 810    | 0        | 0           | 0         |
| 215     | 89    | 38    | 6     | 3382   | 14       | 0           | 0         |
| 221     | 91    | 64    | 6     | 5824   | 8        | 0           | 0         |
| 227     | 14    | 81    | 6     | 1134   | 8        | 0           | 0         |
| 228     | 62    | 41    | 6     | 2542   | 8        | 8           | 0         |
| 229     | 18    | 59    | 6     | 1062   | 0        | 0           | 0         |
| 236     | 42    | 42    | 6     | 1764   | 10       | 28          | 0         |
| 243     | 75    | 52    | 6     | 3900   | 6        | 4           | 0         |
| 259     | 36    | 72    | 6     | 2592   | 0        | 0           | 0         |
| 268     | 32    | 16    | 6     | 512    | 0        | 0           | 4         |
| 273     | 10    | 59    | 6     | 590    | 6        | 24          | 0         |
| 281     | 63    | 60    | 6     | 3780   | 0        | 0           | 0         |
| 282     | 64    | 73    | 6     | 4672   | 0        | 0           | 24        |
| 288     | 78    | 88    | 6     | 6864   | 4        | 6           | 10        |
| 303     | 97    | 88    | 6     | 8536   | 16       | 0           | 0         |
| 321     | 85    | 34    | 6     | 2890   | 14       | 0           | 0         |
| 327     | 70    | 64    | 6     | 4480   | 0        | 0           | 0         |
| 328     | 100   | 53    | 6     | 5300   | 24       | 0           | 0         |
| 330     | 78    | 69    | 6     | 5382   | 0        | 0           | 0         |
| 335     | 93    | 36    | 6     | 3348   | 26       | 0           | 0         |
| 336     | 21    | 84    | 6     | 1764   | 0        | 0           | 0         |
| 341     | 67    | 98    | 6     | 6566   | 6        | 4           | 6         |
| 343     | 39    | 98    | 6     | 3822   | 24       | 0           | 8         |
| 347     | 60    | 29    | 6     | 1740   | 0        | 0           | 0         |
| 352     | 15    | 20    | 6     | 300    | 0        | 0           | 0         |
| 354     | 74    | 39    | 6     | 2886   | 0        | 0           | 0         |
| 362     | 37    | 34    | 6     | 1258   | 0        | 0           | 0         |
| 371     | 88    | 41    | 6     | 3608   | 4        | 0           | 0         |
| 373     | 76    | 34    | 6     | 2584   | 8        | 0           | 0         |
| 377     | 78    | 71    | 6     | 5538   | 0        | 8           | 0         |
| 380     | 65    | 60    | 6     | 3900   | 24       | 0           | 0         |
| 381     | 50    | 31    | 6     | 1550   | 0        | 0           | 0         |
| 384     | 10    | 43    | 6     | 430    | 4        | 8           | 0         |
| 385     | 54    | 57    | 6     | 3078   | 0        | 0           | 0         |
| 392     | 100   | 77    | 6     | 7700   | 0        | 0           | 0         |
| 400     | 32    | 63    | 6     | 2016   | 0        | 0           | 0         |
| 401     | 58    | 21    | 6     | 1218   | 4        | 0           | 0         |
| 411     | 17    | 20    | 6     | 340    | 0        | 0           | 0         |
| 413     | 80    | 17    | 6     | 1360   | 10       | 0           | 0         |
| 414     | 22    | 47    | 6     | 1034   | 0        | 0           | 0         |
| 416     | 96    | 23    | 6     | 2208   | 70       | 14          | 8         |
| 422     | 50    | 96    | 6     | 4800   | 10       | 0           | 0         |
| 430     | 90    | 83    | 6     | 7470   | 12       | 0           | 46        |
| 431     | 88    | 40    | 6     | 3520   | 18       | 0           | 0         |
| 432     | 12    | 68    | 6     | 816    | 0        | 0           | 4         |
| 443     | 68    | 75    | 6     | 5100   | 16       | 14          | 6         |
| 445     | 28    | 70    | 6     | 1960   | 0        | 8           | 0         |
| 446     | 90    | 19    | 6     | 1710   | 0        | 0           | 0         |
| 448     | 46    | 43    | 6     | 1978   | 4        | 0           | 0         |
| 451     | 40    | 48    | 6     | 1920   | 12       | 0           | 0         |
| 455     | 74    | 39    | 6     | 2886   | 12       | 0           | 0         |
| 457     | 23    | 18    | 6     | 414    | 0        | 0           | 0         |
| 459     | 34    | 91    | 6     | 3094   | 8        | 20          | 12        |
| 461     | 66    | 90    | 6     | 5940   | 0        | 0           | 6         |
| 466     | 93    | 92    | 6     | 8556   | 4        | 4           | 0         |
| 467     | 54    | 67    | 6     | 3618   | 10       | 0           | 0         |
| 472     | 83    | 72    | 6     | 5976   | 8        | 4           | 0         |
| 475     | 88    | 35    | 6     | 3080   | 8        | 0           | 0         |
| 476     | 84    | 32    | 6     | 2688   | 40       | 6           | 0         |
| 478     | 78    | 34    | 6     | 2652   | 0        | 4           | 0         |
| 483     | 33    | 30    | 6     | 990    | 0        | 0           | 0         |
| 484     | 27    | 70    | 6     | 1890   | 12       | 0           | 8         |
| 485     | 24    | 36    | 6     | 864    | 0        | 0           | 0         |
| 487     | 69    | 22    | 6     | 1518   | 10       | 8           | 4         |
| 489     | 88    | 77    | 6     | 6776   | 0        | 14          | 18        |
| 490     | 94    | 55    | 6     | 5170   | 4        | 0           | 8         |
| 492     | 52    | 85    | 6     | 4420   | 10       | 0           | 0         |
| 494     | 61    | 20    | 6     | 1220   | 0        | 0           | 0         |
| 500     | 30    | 87    | 6     | 2610   | 0        | 8           | 4         |
| 507     | 56    | 28    | 6     | 1568   | 0        | 4           | 0         |
| 508     | 56    | 97    | 6     | 5432   | 16       | 6           | 0         |
| 515     | 76    | 30    | 6     | 2280   | 14       | 10          | 0         |
| 516     | 36    | 36    | 6     | 1296   | 0        | 0           | 0         |
| 521     | 52    | 11    | 6     | 572    | 0        | 0           | 0         |
| 528     | 92    | 44    | 6     | 4048   | 0        | 4           | 0         |
| 530     | 71    | 54    | 6     | 3834   | 20       | 0           | 6         |
| 535     | 14    | 67    | 6     | 938    | 0        | 0           | 0         |
| 542     | 13    | 48    | 6     | 624    | 4        | 8           | 4         |
| 543     | 77    | 58    | 6     | 4466   | 46       | 6           | 8         |
| 555     | 18    | 29    | 6     | 522    | 0        | 0           | 0         |
| 569     | 78    | 11    | 6     | 858    | 0        | 0           | 0         |
| 572     | 25    | 66    | 6     | 1650   | 0        | 0           | 0         |
| 573     | 44    | 57    | 6     | 2508   | 16       | 0           | 0         |
| 586     | 51    | 34    | 6     | 1734   | 8        | 0           | 0         |
| 593     | 50    | 67    | 6     | 3350   | 12       | 4           | 0         |
| 617     | 46    | 91    | 6     | 4186   | 12       | 4           | 0         |
| 619     | 73    | 16    | 6     | 1168   | 4        | 0           | 0         |
| 622     | 62    | 77    | 6     | 4774   | 18       | 0           | 4         |
| 627     | 92    | 76    | 6     | 6992   | 0        | 0           | 0         |
| 629     | 32    | 37    | 6     | 1184   | 12       | 22          | 0         |
| 630     | 40    | 13    | 6     | 520    | 0        | 4           | 6         |
| 631     | 92    | 40    | 6     | 3680   | 8        | 0           | 0         |
| 633     | 71    | 82    | 6     | 5822   | 6        | 0           | 4         |
| 640     | 18    | 88    | 6     | 1584   | 22       | 0           | 0         |
| 654     | 53    | 66    | 6     | 3498   | 32       | 0           | 0         |
| 657     | 60    | 81    | 6     | 4860   | 0        | 0           | 6         |
| 658     | 77    | 22    | 6     | 1694   | 10       | 0           | 0         |
| 667     | 59    | 86    | 6     | 5074   | 26       | 20          | 28        |
| 671     | 70    | 36    | 6     | 2520   | 18       | 0           | 0         |
| 691     | 79    | 74    | 6     | 5846   | 4        | 6           | 0         |
| 699     | 62    | 77    | 6     | 4774   | 16       | 4           | 0         |
| 701     | 66    | 25    | 6     | 1650   | 0        | 0           | 0         |
| 713     | 52    | 22    | 6     | 1144   | 6        | 0           | 0         |
| 718     | 64    | 63    | 6     | 4032   | 8        | 6           | 0         |
| 725     | 87    | 98    | 6     | 8526   | 12       | 4           | 14        |
| 727     | 18    | 72    | 6     | 1296   | 6        | 0           | 6         |
| 733     | 76    | 65    | 6     | 4940   | 0        | 0           | 0         |
| 737     | 17    | 48    | 6     | 816    | 0        | 0           | 0         |
| 744     | 56    | 65    | 6     | 3640   | 0        | 0           | 4         |
| 752     | 58    | 64    | 6     | 3712   | 8        | 0           | 8         |
| 755     | 100   | 91    | 6     | 9100   | 0        | 6           | 12        |
| 762     | 50    | 15    | 6     | 750    | 4        | 14          | 0         |
| 765     | 32    | 39    | 6     | 1248   | 4        | 0           | 0         |
| 771     | 26    | 95    | 6     | 2470   | 18       | 0           | 0         |
| 774     | 11    | 30    | 6     | 330    | 0        | 6           | 0         |
| 781     | 77    | 30    | 6     | 2310   | 6        | 0           | 0         |
| 784     | 89    | 38    | 6     | 3382   | 16       | 4           | 0         |
| 787     | 23    | 88    | 6     | 2024   | 4        | 4           | 0         |
| 790     | 64    | 72    | 6     | 4608   | 0        | 20          | 0         |
| 803     | 29    | 26    | 6     | 754    | 0        | 6           | 4         |
| 809     | 93    | 62    | 6     | 5766   | 8        | 0           | 0         |
| 814     | 100   | 51    | 6     | 5100   | 4        | 4           | 16        |
| 818     | 62    | 83    | 6     | 5146   | 0        | 4           | 0         |
| 843     | 91    | 100   | 6     | 9100   | 0        | 10          | 0         |
| 845     | 98    | 42    | 6     | 4116   | 8        | 0           | 0         |
| 853     | 45    | 22    | 6     | 990    | 0        | 0           | 0         |
| 854     | 18    | 55    | 6     | 990    | 0        | 0           | 0         |
| 858     | 34    | 96    | 6     | 3264   | 10       | 4           | 0         |
| 870     | 86    | 42    | 6     | 3612   | 26       | 74          | 4         |
| 876     | 97    | 66    | 6     | 6402   | 10       | 6           | 0         |
| 879     | 77    | 54    | 6     | 4158   | 6        | 0           | 0         |
| 881     | 22    | 53    | 6     | 1166   | 0        | 24          | 10        |
| 882     | 25    | 64    | 6     | 1600   | 0        | 0           | 0         |
| 884     | 94    | 68    | 6     | 6392   | 20       | 12          | 0         |
| 886     | 15    | 10    | 6     | 150    | 6        | 54          | 0         |
| 892     | 74    | 49    | 6     | 3626   | 16       | 16          | 0         |
| 900     | 86    | 48    | 6     | 4128   | 26       | 4           | 0         |
| 905     | 87    | 26    | 6     | 2262   | 22       | 0           | 0         |
| 909     | 36    | 48    | 6     | 1728   | 0        | 0           | 0         |
| 911     | 52    | 72    | 6     | 3744   | 22       | 0           | 0         |
| 927     | 86    | 29    | 6     | 2494   | 22       | 0           | 10        |
| 935     | 39    | 28    | 6     | 1092   | 0        | 0           | 0         |
| 943     | 14    | 48    | 6     | 672    | 0        | 4           | 0         |
| 952     | 61    | 24    | 6     | 1464   | 0        | 0           | 0         |
| 956     | 94    | 33    | 6     | 3102   | 8        | 0           | 0         |
| 958     | 11    | 90    | 6     | 990    | 10       | 4           | 0         |
| 959     | 52    | 94    | 6     | 4888   | 8        | 0           | 0         |
| 962     | 19    | 52    | 6     | 988    | 0        | 0           | 0         |
| 976     | 55    | 14    | 6     | 770    | 6        | 140         | 8         |
| 980     | 56    | 63    | 6     | 3528   | 0        | 8           | 0         |
| 981     | 44    | 79    | 6     | 3476   | 24       | 4           | 0         |
| 988     | 60    | 61    | 6     | 3660   | 0        | 0           | 0         |
| 995     | 37    | 94    | 6     | 3478   | 0        | 4           | 0         |
| 997     | 16    | 22    | 6     | 352    | 0        | 4           | 0         |
| 998     | 35    | 100   | 6     | 3500   | 6        | 0           | 0         |
| 999     | 46    | 87    | 6     | 4002   | 30       | 0           | 0         |

restartは丸ごと捨てるのでなくてある位置からそれ以降を捨てるようにしてはどうか。
区分的に解いた結果はそのまま採用しているが、末尾のいくらかを削ることで解けることの保証はそのままに自由度を増やせないか。
そろそろ定数倍最適化か、でも日程的にはまだ。

### 4/22

抜かれてた。正解解法を運良く初手で引いただけなので時間に従って落ちていくのは必然。はやく終わってほしい。
終了は木曜日 4/26 10:00 JST。

| Handle     | Score       | Rank     | Last Submission Time    | Language    | Example Tests  | Submissions    | Current Rating    | Predicted Rating  | Rating Delta |
|------------|-------------|----------|-------------------------|-------------|----------------|----------------|-------------------|-------------------|--------------|
| eldidou    | 867872.34   | 1        | 04.21.2018 16:48:23     | C++         | 3              | 3              | 2560              | 2668.61           | 108.61       |
| machy      | 867500.00   | 2        | 04.22.2018 00:41:02     | C++         | 1              | 5              | 1624              | 1839.22           | 215.22       |
| kimiyuki   | 867021.28   | 3        | 04.21.2018 15:33:40     | C++         | 22             | 8              | 1745              | 2008.98           | 263.98       |

パラメタを弄りながら試してみた。
restartの頻度はあまり影響ないっぽい。
焼き鈍しのパラメタは現状だと0.2がよいっぽい。
1000までのC = 6なseedの残マス数の総和を取った。
現状ですでに偶然にもほぼ最適だったらしい。運は良いが点は上がらない。

| restart | delta | remaining |
|---------|-------|-----------|
| 0.1     | 0.1   | 546       |
| 0.1     | 0.2   | 300       |
| 0.1     | 0.3   | 388       |
| 0.1     | 0.4   | 592       |
| 0.1     | 0.5   | 666       |
| 0.01    | 0.2   | 340       |
| 0.001   | 0.2   | 322       |

時間を10倍にした場合の結果。1000までのC = 6を試して満点が出なかったのは以下の5個。
なんどか試しても満点はでなかったので、これらが悪いのは偶然ではなくて真に難しいということらしい。
特にseed = 273は横長で見るからに難しそう。

| seed    | H     | W     | C     | remaining | area   |
|---------|-------|-------|-------|-----------|--------|
| 273     | 10    | 59    | 6     | 6         | 590    |
| 459     | 34    | 91    | 6     | 12        | 3094   |
| 667     | 59    | 86    | 6     | 4         | 5074   |
| 755     | 100   | 91    | 6     | 4         | 9100   |
| 870     | 86    | 42    | 6     | 4         | 3612   |

次にやること:

-   定数倍最適化
    -    特に `vector<vector<int> >` を `vector<int>` や `array<int, H * W>` に
-   焼き鈍しの効果検証
    -   遷移が一方通行で距離関数に対称性がない 距離空間を成していない 準距離空間
    -   部分的な修正の効果が小さいためrestartで丸ごと取り替えないと局所最適を脱せない
    -   このような状況での焼き鈍しは通常の議論と同様でよいのか
-   近傍の取り方調整
    -   学習節も持たずrestartは損では 最後に残ってしまったマスが消えるように無理矢理修正する遷移の実装

visualizerにGIF出力機能を足した。適切な方法を調べるのが面倒だったので [threepipes/GifWriter.java](https://gist.github.com/threepipes/19d764e35decad6789722b32b58bb1bd/ee357110cdf21f2e4378d7410cff52310bd0e241) の[公式ビジュアライザに埋め込んでgif生成するライブラリ](https://twitter.com/threepipes_s/status/973625923093147648)を借りた。
しかしwrapperというにも薄い薄さなのでこれを眺めながら直接 `javax.imageio.ImageWriter` を叩く選択肢もある気はする。ところで `Thread.sleep(20);` してる意図がよく分からない。

`javax.imageio.ImageWriter` の周り低級すぎてつらい。
非自明なことしようとするとすぐGIFの仕様の知識を要求される。
「さすがにGIFくらい常識でしょ」と言われれば否定はできないが、まだちゃんとやったことないのでつらい。
あと遅い。どうせ後から他のツールで圧縮するため、綺麗な生データ吐いてくれてる点は嬉しい。

最後に消去する区画を中央に寄せてるけど、右下にした方が上手くいったりしないだろうか。あとで試す -> 成功。
`b6cc783f13135ef9e4d8c58a2a5b111fae30bbcb`。
seed = 1000まででの残りマス数総和が 384 -> 238 に。

| seed  | H     | W  | C  | remaining   | area |
|-------|-------|----|----|-------------|------|
| 22    | 54    | 54 | 6  | 22          | 2916 |
| 33    | 29    | 70 | 6  | 12          | 2030 |
| 43    | 70    | 71 | 6  | 10          | 4970 |
| 57    | 30    | 85 | 6  | 8           | 2550 |
| 91    | 97    | 78 | 6  | 10          | 7566 |
| 123   | 23    | 54 | 6  | 10          | 1242 |
| 273   | 10    | 59 | 6  | 4           | 590  |
| 288   | 78    | 88 | 6  | 4           | 6864 |
| 328   | 100   | 53 | 6  | 4           | 5300 |
| 335   | 93    | 36 | 6  | 4           | 3348 |
| 336   | 21    | 84 | 6  | 6           | 1764 |
| 343   | 39    | 98 | 6  | 8           | 3822 |
| 373   | 76    | 34 | 6  | 12          | 2584 |
| 443   | 68    | 75 | 6  | 6           | 5100 |
| 459   | 34    | 91 | 6  | 4           | 3094 |
| 475   | 88    | 35 | 6  | 4           | 3080 |
| 478   | 78    | 34 | 6  | 4           | 2652 |
| 484   | 27    | 70 | 6  | 8           | 1890 |
| 515   | 76    | 30 | 6  | 8           | 2280 |
| 535   | 14    | 67 | 6  | 4           | 938  |
| 542   | 13    | 48 | 6  | 4           | 624  |
| 543   | 77    | 58 | 6  | 8           | 4466 |
| 619   | 73    | 16 | 6  | 4           | 1168 |
| 627   | 92    | 76 | 6  | 12          | 6992 |
| 657   | 60    | 81 | 6  | 4           | 4860 |
| 755   | 100   | 91 | 6  | 10          | 9100 |
| 771   | 26    | 95 | 6  | 8           | 2470 |
| 803   | 29    | 26 | 6  | 8           | 754  |
| 809   | 93    | 62 | 6  | 6           | 5766 |
| 879   | 77    | 54 | 6  | 4           | 4158 |
| 881   | 22    | 53 | 6  | 10          | 1166 |
| 958   | 11    | 90 | 6  | 4           | 990  |
| 976   | 55    | 14 | 6  | 4           | 770  |

`b6cc783f13135ef9e4d8c58a2a5b111fae30bbcb` をそのまま提出。850693.07 -> 850495.05。ちょっと下がった。
おそらくprovisionalでのseedはCの値は気にせず用意しているはずで、残マス数はどうせほとんどすべて0なので運ゲーなためprovisionalの得点はあまり気にしなくてよさそう。
ところでsystem testではC = 6をたくさん走らせてくれるのだろうか。
そうでないと2000ケースとはいえ運の要素が無視できなくなる気がする頼む。
forumで確認取るべきな気もするがどうしよう。どうであれ実装すべきものは変わらないのだけども。

| Handle    | Score       | Rank   | Last Submission Time   | Language  | Example Tests | Submissions | Current Rating   | Predicted Rating | Rating Delta |
|-----------|-------------|--------|------------------------|-----------|---------------|-------------|------------------|------------------|--------------|
| eldidou   | 852475.25   | 1      | 04.22.2018 09:42:47    | C++       | 3             | 4           | 2560             | 2675.50          | 115.50       |
| machy     | 851633.66   | 2      | 04.22.2018 00:41:02    | C++       | 1             | 5           | 1624             | 1839.22          | 215.22       |
| kimiyuki  | 850495.05   | 3      | 04.22.2018 13:19:05    | C++       | 23            | 9           | 1745             | 2022.82          | 277.82       |

![3668ad51342bb205d79f7edccc2828ddcc8c9560](https://user-images.githubusercontent.com/2203128/39097975-c7d353ba-469e-11e8-9cad-3a1c0a5ac8fc.gif)

# 2/23

見つけた: [Marathon Match 100 with Prizes & T-Shirts!](http://success.topcoder.com/the-topcoder-blog/marathon-match-100-with-prizes-t-shirts)。
Tシャツだけだと思ってたのに賞金が出るらしいので引けなくなった。
順位が良い回に賞金チャンスまで降ってきたの運良さすぎだしなんとか落とさず回収したい。
TopCoderに最近登録してMMに初出場の人の中で1位なら全体での2位と同額の賞金もあるらしい。
これ今からでも部の今年の新入生のB1のプロにやらせたら自明に賞金取ってくれそうだなあと思ったのだけど、よく見たら登録日時の条件が 23:59 UTC-4 April 10, 2018 までの閉区間のようで締め切り過ぎてた、なぜ。

| Handle      | Score       | Rank  | Last Submission Time  | Language  | Example Tests | Submissions | Current Rating  | Predicted Rating  | Rating Delta |
|-------------|-------------|-------|-----------------------|-----------|---------------|-------------|-----------------|-------------------|--------------|
| eldidou     | 845929.20   | 1     | 04.22.2018 09:42:47   | C++       | 3             | 4           | 2560            | 2674.05           | 114.05       |
| machy       | 844800.88   | 2     | 04.22.2018 00:41:02   | C++       | 1             | 5           | 1624            | 1839.22           | 215.22       |
| sdya        | 843495.58   | 3     | 04.22.2018 22:44:42   | C++       | 15            | 8           | 2163            | 2288.51           | 125.51       |
| kimiyuki    | 843207.96   | 4     | 04.22.2018 13:19:05   | C++       | 23            | 9           | 1745            | 1993.39           | 248.39       |
| wleite      | 842433.63   | 5     | 04.22.2018 23:39:39   | Java      | 12            | 10          | 2708            | 2716.00           | 8.00         |

下がっていた。
[sdya](https://www.topcoder.com/members/sdya/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんが粘る。提出の雰囲気を見るに私と同様に細かな改善を繰り返していそう。
[wleite](https://www.topcoder.com/members/wleite/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんはいつも立ち上がり遅いけどなぜなのだろう。焼き鈍しなのかな？
最終日には7位ぐらいに落ちてて賞金圏外で終了しそうな予感がある。厳しい。

最後に残ってしまったマスが消えるように無理矢理修正する遷移を実装してみた。
`6ecfcc670dd1d36e2e73cdd584dc6feb3923b979`。
結果は以下。
通常の時間制約の下でseed < 1000のC = 6を全部直列で回して全体で20マスしか残らず、全体で600秒で結果が帰ってきた。
大勝利。
細かい調整はまだなのでほんとに全完があり得る。

| seed  | H     | W     | C     | remaining | area |
|-------|-------|-------|-------|-----------|------|
| 43    | 70    | 71    | 6     | 6         | 4970 |
| 343   | 39    | 98    | 6     | 4         | 3822 |
| 489   | 88    | 77    | 6     | 4         | 6776 |
| 771   | 26    | 95    | 6     | 6         | 2470 |

その提出結果。842675.44 -> 844364.04。2位。
[eldidou](https://www.topcoder.com/members/eldidou/details/?track=DATA_SCIENCE&subTrack=MARATHON_MATCH) さんは全完してそうですね。

| Handle    | Score         | Rank  | Last Submission Time  | Language  | Example Tests | Submissions   | Current Rating    | Predicted Rating  | Rating Delta |
|-----------|---------------|-------|-----------------------|-----------|---------------|---------------|-------------------|-------------------|--------------|
| eldidou   | 845350.88     | 1     | 04.22.2018 09:42:47   | C++       | 3             | 4             | 2560              | 2673.53           | 113.53       |
| kimiyuki  | 844758.77     | 2     | 04.23.2018 08:13:34   | C++       | 24            | 10            | 1745              | 2061.45           | 316.45       |
| machy     | 844232.46     | 3     | 04.22.2018 00:41:02   | C++       | 1             | 5             | 1624              | 1837.87           | 213.87       |
| sdya      | 842872.81     | 4     | 04.22.2018 22:44:42   | C++       | 15            | 8             | 2163              | 2269.72           | 106.72       |
| wleite    | 841842.11     | 5     | 04.22.2018 23:39:39   | Java      | 12            | 10            | 2708              | 2715.98           | 7.98         |

visualizeの結果も自明になってきた。計算にかかった時間に比例して加速させるとかしないと違いが感じられない。

![6ecfcc670dd1d36e2e73cdd584dc6feb3923b979](https://user-images.githubusercontent.com/2203128/39126042-0122a3c6-473c-11e8-97f5-d0a7fbc5134b.gif)

もう残りは高速化と調整しかなさそうに思える。
しかしこう思ったところからさらに後1手の改善をするのがかっこいいしなんとかやってやりたい。

焼き鈍し中で叩いてる貪欲部分について。
もっと貪欲にしてもよかったりしないだろうか。
各点を左上または左下と仮定して長方形を広げる感じで伸ばしていってどうこうする。
対を固定して試した回と同様に依存関係をしたい、あるいはできなくても計算量の次数がひとつ落とせそう。

とりあえず定数倍最適化。`6590463b8426b7dc08080158e1a8fe28ed604676`。
`vector<vector<int> >` を `array<int8_t, MAX_H * MAX_W>` にしたのが目玉。
いくらかは速くなったはず。
手元では変わらないので鯖上での速度を測らないとだめ、自明seedが入力されて即終了する、疑似乱数のseedや実行時間による真の乱数で揺れる、などで計測が面倒。

`681ae9bd3db7a7ab1dbc77ba42b1076490bece42`。
残マス数 k に対し O(k^2HW) で行なっていた削除可能対の探索を O(kHW) でやるようにした。
高速化のため。
正確には色とか圧縮とかでずれてくるのであまり速くならないはずだが、探索順序の変更の影響かseed < 1000を全完できた。
偶然の可能性はあるが。

| seed  | H     | W     | C     | remaining | area |
|-------|-------|-------|-------|-----------|------|
|       |       |       |       |           |      |

とりあえず提出。
1位と同点なのでこれは全完してるなあ。
順位表の1行目に乗りたかった気持ちがあるためすこし複雑な気持ちになる。
ひとりで満足して終えるには不足なのでtwitterに書いて追加で承認を得るやつをしてしまった。
最終順位どう付けるのだろうか、まあ2000ケース使っても同点なら提出時間になるよなあ。
となると精度が上がったからといって常に提出すればいいとも限らなくなってきて困るなあ。
これはForumに質問投げないとだめそう。投げた。英語は疲れるのでだめ。
同点1位の全員に1位の賞金配りますだったらTopCoder大好きになるよ。
しかしこれで「全完できます」が全員に通知されてしまったし情報の優位性が減るなあ。この点数が出せますと言われると意外と出せてしまうため。golfではそうなのだけどしかし普段のマラソンではそんなことない気もする。
しかしなぜ今回こんなに調子が良いんだ。もうすぐ死ぬのかな？

| Handle    | Score     | Rank  | Last Submission Time  | Language  | Example Tests | Submissions   | Current Rating    | Predicted Rating  | Rating Delta  |
|-----------|-----------|-------|-----------------------|-----------|---------------|---------------|-------------------|-------------------|---------------|
| eldidou   | 842360.52 | 1     | 04.22.2018 09:42:47   | C++       | 3             | 4             | 2560              | 2651.70           | 91.70         |
| kimiyuki  | 842360.52 | 1     | 04.23.2018 10:53:55   | C++       | 28            | 11            | 1745              | 2063.98           | 318.98        |
| imazato   | 841437.77 | 3     | 04.23.2018 08:15:19   | C++       | 8             | 8             | 2408              | 2478.95           | 70.95         |

![8d0dd45f2c59b9ded85a37c43a7b646c00f609e5](https://user-images.githubusercontent.com/2203128/39135756-a6057cb6-4754-11e8-9c72-471616d9ac72.gif)

残りはまずはパラメタ調整だろうか。

seed = 10000まで試した結果。総和は72。2時間ちょいかかった。計測つらすぎる。

| seed  | H   | W   | C | remaining | area |
|-------|-----|-----|---|-----------|------|
| 343   | 39  | 98  | 6 | 6         | 3822 |
| 1336  | 97  | 92  | 6 | 4         | 8924 |
| 1900  | 77  | 100 | 6 | 8         | 7700 |
| 2617  | 14  | 66  | 6 | 4         | 924  |
| 3384  | 60  | 57  | 6 | 4         | 3420 |
| 3848  | 27  | 44  | 6 | 4         | 1188 |
| 3939  | 22  | 21  | 6 | 8         | 462  |
| 4131  | 73  | 24  | 6 | 6         | 1752 |
| 4165  | 12  | 13  | 6 | 4         | 156  |
| 6276  | 44  | 47  | 6 | 4         | 2068 |
| 6654  | 82  | 11  | 6 | 8         | 902  |
| 8097  | 68  | 74  | 6 | 4         | 5032 |
| 8210  | 18  | 61  | 6 | 4         | 1098 |

### 4/24

clarに返事が帰ってきた。「seedはランダムに選ばれる」「rating変化について、同点の場合は1.5位扱いで最終提出時間は使わない」だそうな。
<https://apps.topcoder.com/forums/?module=Thread&threadID=916804>。
最終での全完が可能そうなのでしたいですね。
ところで賞金どうなるの。"For rating changes,"と限定があるということは [Nickolas](https://www.topcoder.com/members/Nickolas/) さんはこれを知らないということだろうか。

順位は動かず。

| Handle       | Score         | Rank    | Last Submission Time    | Language   | Example Tests | Submissions   | Current Rating | Predicted Rating  | Rating Delta |
|--------------|---------------|---------|-------------------------|------------|---------------|---------------|----------------|-------------------|--------------|
| eldidou      | 842298.39     | 1       | 04.22.2018 09:42:47     | C++        | 3             | 4             | 2560           | 2648.07           | 88.07        |
| kimiyuki     | 842298.39     | 1       | 04.23.2018 10:53:55     | C++        | 28            | 11            | 1745           | 2056.84           | 311.84       |
| sdya         | 841491.94     | 3       | 04.23.2018 17:15:25     | C++        | 19            | 10            | 2163           | 2284.92           | 121.92       |
| wleite       | 841391.13     | 4       | 04.23.2018 22:47:34     | Java       | 17            | 14            | 2708           | 2723.76           | 15.76        |
| imazato      | 841209.68     | 5       | 04.23.2018 08:15:19     | C++        | 8             | 8             | 2408           | 2444.82           | 36.82        |
| machy        | 840987.90     | 6       | 04.23.2018 18:29:31     | C++        | 2             | 7             | 1624           | 1789.54           | 165.54       |
| hakomo       | 840604.84     | 7       | 04.23.2018 09:16:47     | C++        | 3             | 2             | 2281           | 2327.81           | 46.81        |
| WA\_TLE      | 837782.26     | 8       | 04.23.2018 02:50:13     | C++        | 10            | 4             | 1552           | 1864.94           | 312.94       |
| bduvenhage   | 837399.19     | 9       | 04.23.2018 11:41:34     | C++        | 12            | 10            | 1829           | 1944.57           | 115.57       |
| xyz600       | 837177.42     | 10      | 04.23.2018 22:40:16     | C++        | 24            | 5             | 1505           | 1660.25           | 155.25       |

パラメタ調整は時間がかかり過ぎるため難しい。賞金を前借りして計算資源に変えるべきだろうか。
そういえばpragmaしてない。焼き鈍しの採択確率関数いじるやつしてない。小区画を解くとき必ずしも最小値を達成する必要があるかの考察してない。
横や縦に並んで残るのが難しいように見えるため、残マス数ではない評価関数を最小化してみるのはどうか。

蛇行させるのはどうか。
これは正しそう。
根拠としては次のふたつの図。
4 * 4 の小区画に切ったときの各区画が処理される回数を示している。
上が現在のように y + x の順に処理するもの、下が (y, x) = (0, 2) から蛇行させて最後に (0, 3) を残すもの。
均一に処理されるため最後に全体を処理する時点に持ち越される点の数が少なくなることが期待される。
小区画を解くときに必ずしも最小値を達成する必要がないとして早めに打ち切る方針を試したが失敗したこととも矛盾しない。

| 15 | 10 | 7  | 3 |
|----|----|----|---|
| 10 | 8  | 5  | 2 |
| 7  | 5  | 3  | 1 |
| 3  | 2  | 1  | . |

| 8  | 8  | 8  | . |
|----|----|----|---|
| 8  | 7  | 6  | 1 |
| 6  | 6  | 6  | 2 |
| 6  | 5  | 4  | 3 |

計算資源借りた。AWS EC2 c5.2xlarge spot instance us-east-1f 時価$0.13/hour。
3.00GHzでavx512まで使えて物理コアが4個見える。
spot instance とても安くてすごい。入札期限の設定を流用してMM期間終了と同時にinstance落ちる設定にもできるし便利すぎる。
でもTopCoderの鯖上では2.80GHzだしたぶんavx512はだめなので合わせておくべきだった気がする。
環境がbenchmark取るのに適してるのかよく分からないがまあ大丈夫でしょうという気持ちがある、ただし細かい定数倍高速化以外とする。

[GifWriter.java](https://gist.github.com/threepipes/19d764e35decad6789722b32b58bb1bd/ee357110cdf21f2e4378d7410cff52310bd0e241) のcompileがこけた。
コード中に日本語を書くのやめてほしい。
次からは自分で直接 `javax.imageio.ImageWriter` 叩くようにしたい。

``` java
GifWriter.java:13: error: unmappable character for encoding ASCII
     * @param filename gif??????????????????????????????????????????
```

cloud上での実行結果は以下。seed < 10000でC = 6のものをすべて試した。
同じ `8d0dd45f2c59b9ded85a37c43a7b646c00f609e5` なんだけどちょっと悪くなってない？
なんで？
環境が同じなら比較可能だろうからいいけどなんで？

| seed  | H     | W     | C     | remaining | elapsed |
|-------|-------|-------|-------|-----------|---------|
| 273   | 10    | 59    | 6     | 6         | 8.80013 |
| 343   | 39    | 98    | 6     | 6         | 8.80355 |
| 1717  | 89    | 46    | 6     | 6         | 8.80286 |
| 1817  | 66    | 44    | 6     | 12        | 8.80194 |
| 2120  | 86    | 83    | 6     | 10        | 8.80534 |
| 2217  | 10    | 37    | 6     | 8         | 8.80025 |
| 2733  | 32    | 11    | 6     | 4         | 8.80028 |
| 3551  | 10    | 39    | 6     | 8         | 8.8     |
| 4080  | 39    | 80    | 6     | 6         | 8.802   |
| 4165  | 12    | 13    | 6     | 4         | 8.80013 |
| 4509  | 14    | 46    | 6     | 4         | 8.80023 |
| 4840  | 10    | 15    | 6     | 4         | 8.8     |
| 5446  | 55    | 62    | 6     | 20        | 8.80219 |
| 5623  | 55    | 68    | 6     | 4         | 8.80271 |
| 5857  | 68    | 44    | 6     | 4         | 8.80286 |
| 5972  | 49    | 72    | 6     | 8         | 8.80565 |
| 6276  | 44    | 47    | 6     | 22        | 8.8009  |
| 6384  | 34    | 14    | 6     | 4         | 8.79972 |
| 6452  | 62    | 53    | 6     | 4         | 8.79813 |
| 6926  | 70    | 12    | 6     | 4         | 8.79956 |
| 7409  | 76    | 72    | 6     | 4         | 8.80405 |
| 7416  | 42    | 83    | 6     | 8         | 8.80223 |
| 7825  | 93    | 20    | 6     | 52        | 8.8001  |
| 8097  | 68    | 74    | 6     | 6         | 8.80874 |
| 8109  | 90    | 13    | 6     | 4         | 8.79969 |
| 8882  | 58    | 59    | 6     | 4         | 8.80143 |
| 9465  | 34    | 48    | 6     | 4         | 8.80121 |
| 9590  | 10    | 52    | 6     | 4         | 8.80007 |
| 9837  | 24    | 79    | 6     | 4         | 8.80101 |

`a40dfcc54f8f2cdd9155d0fc5ceb02315e76d1b2`。蛇行させてみた。cloud上での結果は以下。

| seed | H  | W  | C | remaining | elapsed |
|------|----|----|---|-----------|---------|
| 4    | 52 | 83 | 6 | 4         | 8.80292 |
| 113  | 93 | 92 | 6 | 8         | 8.80883 |
| 958  | 11 | 90 | 6 | 4         | 8.80062 |
| 2711 | 20 | 32 | 6 | 4         | 8.80035 |
| 2838 | 67 | 50 | 6 | 6         | 8.80225 |
| 2937 | 18 | 23 | 6 | 4         | 8.79844 |
| 3551 | 10 | 39 | 6 | 4         | 8.8001  |
| 4165 | 12 | 13 | 6 | 4         | 8.79964 |
| 4260 | 56 | 84 | 6 | 6         | 8.80271 |
| 4709 | 47 | 98 | 6 | 4         | 8.80352 |
| 4840 | 10 | 15 | 6 | 6         | 8.79943 |
| 5441 | 48 | 77 | 6 | 6         | 8.8036  |
| 5909 | 60 | 10 | 6 | 20        | 8.80049 |
| 6428 | 80 | 18 | 6 | 6         | 8.80082 |
| 6536 | 30 | 15 | 6 | 6         | 8.80016 |
| 6553 | 98 | 97 | 6 | 6         | 8.80829 |
| 7061 | 94 | 95 | 6 | 6         | 8.808   |

![a40dfcc54f8f2cdd9155d0fc5ceb02315e76d1b2](https://user-images.githubusercontent.com/2203128/39192517-4be84f86-4814-11e8-8d55-791d4c5b5b35.gif)

蛇行が分かりやすい例は次のseed = 3。

![a40dfcc54f8f2cdd9155d0fc5ceb02315e76d1b2 1](https://user-images.githubusercontent.com/2203128/39192521-4eabe0ac-4814-11e8-83b9-be3d79b93b13.gif)

pragmaについて。
`#pragma GCC target "avx"` はillegal instructionした。そういえばそうだった。
<https://apps.topcoder.com/forums/?module=Thread&threadID=898403&start=15> によると `#pragma GCC target "sse4.2"` するとよいらしい。ちょっと良くなった気がする。
しかし `#pragma GCC optimize "O3"` するとcompile time TLEする。
こういうのはstackに取った配列が原因なので静的領域に移せばよいのだが、これをしたらなぜか実行時速度が悪化した。静的領域の変数は関数呼び出しのたびに退避と復帰が発生するからだろう。
そもそも静的領域に移してもcompile遅い雰囲気あるし、もし本番前にもう一度compile走るとかでうっかり死なれると困るので触らない方が良さそう。
最新のをくれとは言わないのでせめて今のAtCoderぐらいの環境をください。

時間ももう少しぎりぎりまで使うようにした。といっても安全を見て9.3秒ぐらいで止まってる。
HとWの一方が小さく一方が大きいケースで区画が小さすぎる問題を対応した。
でもなんだか残マス数の最大値が増えてるなんで。
なんだか収束に必要な回数試行できてない感じもある。
1000回に6回ぐらい発生する事象について意味のあることを言うにはどれくらい試行すればいいのか、確率論の知識が無なのだめすぎる。それぐらい常識なのでは。教養がほしい。
そして初めから10 * 10とかの場合がどうしようもない。どうしよう。

[task spooler](http://vicerveza.homeunix.net/~viric/soft/ts/) が便利っぽい。
`$ apt install task-spooler` で導入、 `$ tsp ls -l` で投入、 `$ tsp` で確認。
`at` commandにもqueue機能はあるけど不足。これからはこの子を使っていきたい。
この子もattach機能はないっぽいけどまあ仕方なし。

ところで本業の数学が止まっててよくない。
待機時間にやればいいのだけどコンテキストスイッチが苦手なのでどうしても止まる。
でも今回はすごく勢いよいので時間が無限に溶ける。
そもそも数学をするにもしないにもまず赤くならないと人生が続かないので許してくれという気持ちもある。
そういえばrating delta予測が +300 越えてるのが楽しすぎる。
取得数制限によるバグで精度悪いけど、下側に人が増えても損をすることはないはずだしそうであるべき。
「performance値から考えて最低でも8位以上には入らないと一生赤にはなれない」と思うと厳しく感じるけど「2回連続で1位を取れば赤」と思えば運良くなれちゃいそうな感じがしてくる。

`1ce87584812f0e9fb59a2857773d88e5316f9755` 提出。
全完解除されてしまった。
分散が大きくて明確ではないが、しかし確実に改善されてるはずなのでこのままでよし。
むしろこの微妙に下げるやつは全完を見た直後にやるべきだった。嬉しくなってtwitterに報告するとか理性がなさすぎる。

| Handle     | Score      | Rank | Last Submission Time | Language   | Example Tests | Submissions   | Current Rating    | Predicted Rating  | Rating Delta |
|------------|------------|------|----------------------|------------|---------------|---------------|-------------------|-------------------|--------------|
| eldidou    | 834446.56  | 1    | 04.22.2018 09:42:47  | C++        | 3             | 4             | 2560              | 2674.32           | 114.32       |
| kimiyuki   | 834217.56  | 2    | 04.24.2018 16:29:41  | C++        | 34            | 13            | 1745              | 2064.36           | 319.36       |
| hakomo     | 833893.13  | 3    | 04.24.2018 08:31:47  | C++        | 3             | 3             | 2281              | 2382.22           | 101.22       |
| imazato    | 833549.62  | 4    | 04.24.2018 11:28:54  | C++        | 10            | 10            | 2408              | 2462.02           | 54.02        |
| WA\_TLE    | 833511.45  | 5    | 04.24.2018 04:59:32  | C++        | 12            | 6             | 1552              | 1935.44           | 383.44       |

`1ce87584812f0e9fb59a2857773d88e5316f9755` の結果の例としては以下。
この例の総和は118。56とか130もでるが平均的には100ぐらいになるはず。
`8d0dd45f2c59b9ded85a37c43a7b646c00f609e5` の場合は128や238となるので明らかに改善されてる。

| seed    | H       | W       | C       | remaining | elapsed |
|---------|---------|---------|---------|-----------|---------|
| 1417    | 23      | 84      | 6       | 4         | 8.801   |
| 2532    | 20      | 67      | 6       | 4         | 8.80073 |
| 2825    | 81      | 10      | 6       | 10        | 8.79924 |
| 3268    | 39      | 20      | 6       | 6         | 8.79906 |
| 4165    | 12      | 13      | 6       | 4         | 8.80006 |
| 4299    | 91      | 58      | 6       | 6         | 8.8041  |
| 4308    | 91      | 16      | 6       | 12        | 8.80093 |
| 4840    | 10      | 15      | 6       | 6         | 8.80003 |
| 5055    | 93      | 98      | 6       | 6         | 8.80406 |
| 5098    | 12      | 42      | 6       | 6         | 8.7996  |
| 5360    | 20      | 56      | 6       | 6         | 8.80038 |
| 5656    | 62      | 67      | 6       | 6         | 8.80333 |
| 6428    | 80      | 18      | 6       | 6         | 8.79274 |
| 6758    | 28      | 51      | 6       | 4         | 8.79979 |
| 6775    | 67      | 14      | 6       | 4         | 8.79851 |
| 7061    | 94      | 95      | 6       | 4         | 8.80943 |
| 7967    | 82      | 55      | 6       | 4         | 8.80414 |
| 8325    | 20      | 43      | 6       | 4         | 8.80012 |
| 8682    | 53      | 10      | 6       | 4         | 8.79379 |
| 9307    | 48      | 97      | 6       | 8         | 8.80335 |
| 9590    | 10      | 52      | 6       | 4         | 8.79928 |

次の問題は 12 * 13 のような場合、つまり探索そのものの部分の改善。
パラメタ調整で乗り切れればよいのだが。

## 4/25

パラメタ調整。手元よりはるかにましとはいえ、借りた環境でも遅くてあまり進まない。
throughputは足りてるとしてもlatencyが大きい。
ひとつのinstanceを借りっぱなしにするのではなく、同じ計算資源量でも必要なときに同時に複数instances建てて不要になったら落とすような運用が必要。

## 4/26

機能してなさそうな部分を消した。精度は落ちてないがよくみたら時間が少し落ちてる。
10000 < seedの全完含めた総和が4000秒から4600秒になるっぽいが、しかしコードが削れる方がえらい。

残ったマスを消すような遷移に優先度を付けた。seed < 10000の総和は54ぐらいが平均。細かい選択はまだなのでcommitはまだ。

| seed  | H   | W   | C  | remaining | elapsed |
|-------|-----|-----|----|-----------|---------|
| 3268  | 39  | 20  | 6  | 6         | 9.30087 |
| 4165  | 12  | 13  | 6  | 4         | 9.30027 |
| 5324  | 17  | 80  | 6  | 4         | 9.30145 |
| 5745  | 90  | 87  | 6  | 8         | 9.30937 |
| 6798  | 98  | 69  | 6  | 6         | 9.30818 |
| 7951  | 57  | 80  | 6  | 6         | 9.3054  |
| 8325  | 20  | 43  | 6  | 6         | 9.301   |
| 8569  | 87  | 60  | 6  | 4         | 9.3059  |
| 9307  | 48  | 97  | 6  | 6         | 9.30466 |
| 9982  | 100 | 100 | 6  | 4         | 9.31163 |

seed = 4165が最も難しいseedのようだ。次の図のように左下の桃赤桃が厳しい。
一方でこれをちゃんと解き切ってくれることもあるため、最終テストにこういうのが少数だけ混入すると運ゲーになりそう。

![4165](https://user-images.githubusercontent.com/2203128/39253893-e71a68ac-48e3-11e8-9688-170fa9a0daee.gif)

もう待つぐらいしかやることがないので諸々を眺めている。
全完者が増えてる。

| Handle       | Score     | Rank | Last Submission Time     | Language  | Example Tests  | Submissions    | Current Rating | Predicted Rating    | Rating Delta   |
|--------------|-----------|------|--------------------------|-----------|----------------|----------------|----------------|---------------------|----------------|
| eldidou      | 823455.88 | 1    | 04.22.2018 09:42:47      | C++       | 3              | 4              | 2560           | 2637.71             | 77.71          |
| imazato      | 823455.88 | 1    | 04.24.2018 17:59:02      | C++       | 15             | 11             | 2408           | 2490.69             | 82.69          |
| wleite       | 823455.88 | 1    | 04.25.2018 03:45:03      | Java      | 21             | 18             | 2708           | 2751.38             | 43.38          |
| kimiyuki     | 823161.76 | 4    | 04.24.2018 16:29:41      | C++       | 36             | 13             | 1745           | 1997.41             | 252.41         |
| hakomo       | 823088.24 | 5    | 04.25.2018 09:52:37      | C++       | 3              | 4              | 2281           | 2352.97             | 71.97          |
| JacoCronje   | 822830.88 | 6    | 04.25.2018 09:05:02      | C++       | 12             | 8              | 2231           | 2290.53             | 59.53          |
| ebicochineal | 822297.79 | 7    | 04.25.2018 06:02:34      | C++       | 18             | 21             | 1623           | 1827.85             | 204.85         |
| WA\_TLE      | 822187.50 | 8    | 04.24.2018 04:59:32      | C++       | 12             | 6              | 1552           | 1880.67             | 328.67         |
| sdya         | 822003.68 | 9    | 04.25.2018 01:35:16      | C++       | 24             | 16             | 2163           | 2222.08             | 59.08          |
| xyz600       | 821011.03 | 10   | 04.25.2018 08:53:06      | C++       | 30             | 9              | 1505           | 1670.13             | 165.13         |

